// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider     = "prisma-client"
  output       = "../src/generated"
  moduleFormat = "cjs"
}

datasource db {
  provider = "postgresql"
}

model Auth {
  id        Int            @id @default(autoincrement())
  userId    Int            @unique
  password  String
  otp       Int?
  status    AuthStatusEnum @default(Active)
  createdAt DateTime       @default(now())
  updatedAt DateTime       @updatedAt
  lastLogin DateTime?

  user User @relation(fields: [userId], references: [id])

  @@map("auths")
}

model Invitation {
  id         Int                  @id @default(autoincrement())
  email      String               @unique
  token      String               @unique
  role       UserRoleEnum         @default(User)
  department DepartmentEnum       @default(None)
  status     InvitationStatusEnum @default(Pending)
  createdAt  DateTime             @default(now())
  updatedAt  DateTime             @updatedAt

  @@map("invitations")
}

model User {
  id          Int            @id @default(autoincrement())
  email       String         @unique
  firstName   String
  lastName    String
  phone       String?
  image       String?
  otp         Int?
  permissions String[]       @default([])
  role        UserRoleEnum   @default(User)
  department  DepartmentEnum @default(None)
  status      UserStatusEnum @default(Active)
  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt
  auth        Auth?

  @@map("users")
}

model Program {
  id          Int       @id @default(autoincrement())
  name        String    @unique
  description String
  bannerImage String?
  category    String // Educational, Medical, Business etc.
  subCategory String?
  isActive    Boolean   @default(false)
  startDate   DateTime?
  endDate     DateTime?

  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  applications Application[]

  @@map("programs")
}

model Application {
  id                   Int       @id @default(autoincrement())
  email                String
  firstName            String
  applicationNo        String    @unique
  middleName           String?
  lastName             String
  dob                  DateTime?
  gender               String?
  school               String?
  faculty              String?
  department           String?
  regNo                String?   @unique // school registration number
  level                Int?
  programDuration      Int?
  state                String?
  lga                  String?
  village              String?
  address              String?
  ekpuk                String?
  phone                String
  bankName             String?
  accountNo            String?
  nin                  String
  passport             String?
  examsType            String?
  nameOfSchool         String?
  subjectGrade         String?
  year                 String?
  admissionLetter      String?
  lastSchoolFeeReciept String?
  status               String    @default("In Progress")
  type                 String?
  programId            Int
  schoolIdCard         String?
  certificateOfOrigin  String?
  ssceResult           String?
  birthCertificate     String?
  comment              String?

  program Program @relation(fields: [programId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("applications")
}

enum UserRoleEnum {
  User
  Admin
  Editor
  Developer
  Student
  Contractor
}

enum UserStatusEnum {
  Active
  Inactive
  Suspended
  Blocked
}

enum InvitationStatusEnum {
  Pending
  Accepted
  Declined
}

enum AuthStatusEnum {
  Active
  Inactive
  Locked
}

// enum OfficeEnum {
//   None
//   Account
//   Manager
// }

enum DepartmentEnum {
  None
  HR
  IT
  Sales
  Marketing
  Finance
  Operations
  Legal
  Admin
}
